<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PawfectFind - Premium Pet Services Marketplace in Singapore</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="style.css">

</head>
<body>
    <header>
        <div class="container header-content">
            <a href="index.html" class="logo">
                <img src="images/PawfectFind_logo.png" alt="PawfectFind Logo" 
                    class="logo-img">
            </a>
            <nav>
                <ul>
                    <li><a href="index.html" class="active">Home</a></li>
                    <li><a href="services.html">Services</a></li>
                    <li><a href="providers.html">Providers</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </nav>
            <div class="header-actions">
            <div class="cart-icon">
                <i class="fas fa-shopping-cart"></i>
            <span class="cart-badge">2</span>
            </div>
            <div class="user-icon" id="userIcon">
                <i class="fas fa-user"></i>
            <span id="userStatus" style="display: none;"></span>
            </div>
            </div>
        </div>
    </header>

    <!-- React Booking System will be rendered here -->
    <div id="root"></div>

    <!--<section class="page-header">
        <div class="container">
            <h1 class="page-title">Singapore's Premier Pet Services Marketplace</h1>
            <p class="breadcrumb">
                <a href="index.html">Home</a> / Welcome
            </p>
        </div>
    </section>-->

    <main class="main-content">
        <div class="container">
            <h2 class="section-title">Featured Services</h2>
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-img" style="background-image: url('https://images.unsplash.com/photo-1525253013412-55c1a69a5738?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80')">
                        <div class="service-badge">Most Popular</div>
                    </div>
                    <div class="service-content">
                        <h3 class="service-title">Premium Pet Grooming</h3>
                        <p class="service-desc">Professional grooming services with certified groomers across Singapore.</p>
                        <ul class="service-features">
                            <li>Full wash & dry service</li>
                            <li>Nail trimming & ear cleaning</li>
                            <li>Professional styling</li>
                            <li>Flea & tick treatment</li>
                        </ul>
                        <div class="service-footer">
                            <div class="service-price">From $45</div>
                            <a href="booking.html?service=grooming" class="btn btn-primary">Book Now</a>
                        </div>
                    </div>
                </div>

                <div class="service-card">
                    <div class="service-img" style="background-image: url('https://images.unsplash.com/photo-1596272875729-ed2ff7d6d9c5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80')">
                        <div class="service-badge">Trusted</div>
                    </div>
                    <div class="service-content">
                        <h3 class="service-title">Reliable Pet Sitting</h3>
                        <p class="service-desc">Experienced pet sitters for day care or overnight stays in your home.</p>
                        <ul class="service-features">
                            <li>Background-checked sitters</li>
                            <li>Daily photo updates</li>
                            <li>Exercise & playtime</li>
                            <li>Emergency care support</li>
                        </ul>
                        <div class="service-footer">
                            <div class="service-price">From $30/day</div>
                            <a href="booking.html?service=sitting" class="btn btn-primary">Book Now</a>
                        </div>
                    </div>
                </div>

                <div class="service-card">
                    <div class="service-img" style="background-image: url('https://images.unsplash.com/photo-1450778869180-41d0601e046e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1155&q=80')">
                        <div class="service-badge">Luxury</div>
                    </div>
                    <div class="service-content">
                        <h3 class="service-title">Premium Pet Hotels</h3>
                        <p class="service-desc">5-star boarding facilities with round-the-clock care and supervision.</p>
                        <ul class="service-features">
                            <li>Climate-controlled suites</li>
                            <li>24/7 veterinary support</li>
                            <li>Daily exercise programs</li>
                            <li>Gourmet meal service</li>
                        </ul>
                        <div class="service-footer">
                            <div class="service-price">From $60/night</div>
                            <a href="booking.html?service=hotel" class="btn btn-primary">Book Now</a>
                        </div>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin: 50px 0;">
                <a href="services.html" class="btn btn-secondary">View All Services</a>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>PawfectFind</h3>
                    <p>Singapore's most trusted pet services marketplace connecting pet parents with verified professionals.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Services</h3>
                    <ul>
                        <li><a href="booking.html?service=grooming">Pet Grooming</a></li>
                        <li><a href="booking.html?service=sitting">Pet Sitting</a></li>
                        <li><a href="booking.html?service=hotel">Pet Hotels</a></li>
                        <li><a href="booking.html?service=training">Pet Training</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="providers.html">Service Providers</a></li>
                        <li><a href="contact.html">Contact Us</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contact Info</h3>
                    <ul>
                        <li><i class="fas fa-phone"></i> +65 6123 4567</li>
                        <li><i class="fas fa-envelope"></i> hello@pawfectfind.sg</li>
                        <li><i class="fas fa-map-marker-alt"></i> 123 Pet Road, Singapore 123456</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2025 PawfectFind. All rights reserved.</p>
            </div>
        </div>
    </footer>

<!-- React and Babel Scripts -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- React Booking System Component -->
    <script type="text/babel">
        const { useState, useEffect } = React;

        const PetServicesApp = () => {
            const [petType, setPetType] = useState('');
            const [location, setLocation] = useState('');
            const [petService, setPetService] = useState('');
            const [selectedDate, setSelectedDate] = useState('');
            const [selectedVendor, setSelectedVendor] = useState(null);
            const [showPetDropdown, setShowPetDropdown] = useState(false);
            const [showLocationDropdown, setShowLocationDropdown] = useState(false);
            const [showServiceDropdown, setShowServiceDropdown] = useState(false);
            
            // Calendar state
            const [currentMonth, setCurrentMonth] = useState(new Date().getMonth());
            const [currentYear, setCurrentYear] = useState(new Date().getFullYear());

            // ADD API CONFIGURATION HERE:
            const API_BASE_URL = window.location.hostname.includes('localhost') 
                ? 'http://localhost:5000' 
                : 'https://pawfectfind-backend.azurewebsites.net';

            // ADD STATE FOR BACKEND VENDORS:
            const [backendVendors, setBackendVendors] = useState([]);
            const [isLoading, setIsLoading] = useState(true);

            const petTypes = [
                'Dogs', 'Cats', 'Rabbits', 'Hamsters', 'Guinea Pigs', 
                'Chinchillas', 'Ferrets', 'Birds', 'Turtles', 'Iguanas'
            ];

            const locations = [
                'Central (District 1-2)', 'West (District 5-8, 22-23)', 
                'East (District 14-18)', 'North (District 19-21, 26-28)', 
                'South (District 3-4, 9-10)', 'North-East (District 11-13, 24-25)'
            ];

            const services = ['Grooming', 'Sitter', 'Pet Hotel'];
                         
            // ADD API FUNCTIONS:
            const fetchVendors = async () => {
                try {
                    setIsLoading(true);
                    const response = await fetch(`${API_BASE_URL}/api/vendors`);
                    if (response.ok) {
                        const vendorsData = await response.json();
                        setBackendVendors(vendorsData);
                    } else {
                        console.error('Failed to fetch vendors');
                        // Fallback to local vendors if API fails
                        setBackendVendors(localVendors);
                    }
                } catch (error) {
                    console.error('Error fetching vendors:', error);
                    // Fallback to local vendors
                    setBackendVendors(localVendors);
                } finally {
                    setIsLoading(false);
                }
            };

            const loginUser = async (email, password) => {
                try {
                    const response = await fetch(`${API_BASE_URL}/api/auth/login`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email, password })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        localStorage.setItem('token', data.access_token);
                        localStorage.setItem('user', JSON.stringify(data.user));
                        return data;
                    } else {
                        throw new Error('Login failed');
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    throw error;
                }
            };

            const registerUser = async (email, password, full_name, phone_number) => {
                try {
                    const response = await fetch(`${API_BASE_URL}/api/auth/register`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email, password, full_name, phone_number })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        localStorage.setItem('token', data.access_token);
                        localStorage.setItem('user', JSON.stringify(data.user));
                        return data;
                    } else {
                        throw new Error('Registration failed');
                    }
                } catch (error) {
                    console.error('Registration error:', error);
                    throw error;
                }
            };

            // FETCH VENDORS WHEN COMPONENT LOADS:
            useEffect(() => {
                fetchVendors();
            }, []);

            // Local vendor data as fallback
            const localVendors = [
                {
                    id: 'paws',
                    name: 'Paws & Claws Grooming',
                    rating: 4.9,
                    services: ['Grooming', 'Breed Specialist'],
                    price: 'From $45',
                    availability: {
                        '2025-09-15': 'available',
                        '2025-09-16': 'limited',
                        '2025-09-17': 'booked',
                        '2025-09-18': 'available',
                        '2025-09-19': 'available',
                        '2025-09-21': 'limited',
                        '2025-09-22': 'available',
                        '2025-09-23': 'booked',
                        '2025-09-24': 'available',
                        '2025-09-25': 'limited',
                    }
                },
                {
                    id: 'furry',
                    name: 'Small Animals Grooming',
                    rating: 4.9,
                    services: ['Grooming', 'Breed Specialist'],
                    price: 'From $45',
                    availability: {
                        '2025-09-26': 'available',
                        '2025-09-27': 'limited',
                        '2025-09-28': 'booked',
                        '2025-09-29': 'available',
                        '2025-09-30': 'available',
                        '2025-10-1': 'limited',
                        '2025-10-2': 'available',
                        '2025-10-3': 'booked',
                        '2025-10-4': 'available',
                        '2025-10-5': 'limited',
                    }
                },
                {
                    id: 'happy',
                    name: 'Happy Tails Pet Hotel',
                    rating: 4.7,
                    services: ['Pet Hotel', 'Boarding', 'Day Care'],
                    price: 'From $60/night',
                    availability: {
                        '2025-09-15': 'limited',
                        '2025-09-16': 'available',
                        '2025-09-17': 'available',
                        '2025-09-18': 'limited',
                        '2025-09-19': 'booked',
                        '2025-09-21': 'available',
                        '2025-09-22': 'available',
                        '2025-09-23': 'limited',
                        '2025-09-24': 'booked',
                        '2025-09-25': 'available',
                    }
                },
                {
                    id: 'bark',
                    name: 'Bark Avenue Training',
                    rating: 4.8,
                    services: ['Obedience Training', 'Puppy Classes', 'Behavioral'],
                    price: 'From $75/session',
                    availability: {
                        '2025-09-15': 'available',
                        '2025-09-16': 'booked',
                        '2025-09-17': 'available',
                        '2025-09-18': 'available',
                        '2025-09-19': 'limited',
                        '2025-09-21': 'booked',
                        '2025-09-22': 'available',
                        '2025-09-23': 'limited',
                        '2025-09-24': 'available',
                        '2025-09-25': 'booked',
                    }
                },
                {
                    id: 'whiskers',
                    name: 'Whiskers Wellness',
                    rating: 4.6,
                    services: ['Veterinary', 'Wellness', 'Dental Care'],
                    price: 'From $55',
                    availability: {
                        '2025-09-15': 'booked',
                        '2025-09-16': 'available',
                        '2025-09-17': 'limited',
                        '2025-09-18': 'booked',
                        '2025-09-19': 'available',
                        '2025-09-21': 'available',
                        '2025-09-22': 'limited',
                        '2025-09-23': 'available',
                        '2025-09-24': 'booked',
                        '2025-09-25': 'available',
                    }
                }
            ];

            // Use backend vendors if available, otherwise fallback to local
            const vendors = backendVendors.length > 0 ? backendVendors : localVendors;

            const toggleDropdown = (dropdown) => {
                if (dropdown === 'pet') {
                    setShowPetDropdown(!showPetDropdown);
                    setShowLocationDropdown(false);
                    setShowServiceDropdown(false);
                } else if (dropdown === 'location') {
                    setShowLocationDropdown(!showLocationDropdown);
                    setShowPetDropdown(false);
                    setShowServiceDropdown(false);
                } else if (dropdown === 'service') {
                    setShowServiceDropdown(!showServiceDropdown);
                    setShowPetDropdown(false);
                    setShowLocationDropdown(false);
                }
            };

            const handleSearch = (e) => {
                if (!selectedDate || !selectedVendor) {
                    e.preventDefault();
                    alert('Please select both a date and a vendor first');
                    return;
                }
                
                // The button will naturally navigate to booking.html
                // with query parameters via the href

                            // Check if user is logged in
                const user = localStorage.getItem('user');
                if (!user) {
                    e.preventDefault();
                    alert('Please login first to make a booking');
                    // You could redirect to login page here
                    return;
                }
            };
            
            // Calendar functions
            const getDaysInMonth = (month, year) => {
                return new Date(year, month + 1, 0).getDate();
            };
            
            const getFirstDayOfMonth = (month, year) => {
                return new Date(year, month, 1).getDay();
            };
            
            const navigateMonth = (direction) => {
                if (direction === 'prev') {
                    if (currentMonth === 0) {
                        setCurrentMonth(11);
                        setCurrentYear(currentYear - 1);
                    } else {
                        setCurrentMonth(currentMonth - 1);
                    }
                } else {
                    if (currentMonth === 11) {
                        setCurrentMonth(0);
                        setCurrentYear(currentYear + 1);
                    } else {
                        setCurrentMonth(currentMonth + 1);
                    }
                }
            };
            
            const formatDate = (day) => {
                return `${currentYear}-${(currentMonth + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
            };
            
            const getDayAvailability = (day) => {
                const dateStr = formatDate(day);
                
                // If no vendor is selected, show unknown availability
                if (!selectedVendor) return 'unknown';
                
                // Find the selected vendor's availability for this date
                const vendor = vendors.find(v => v.id === selectedVendor);
                return vendor.availability ? (vendor.availability[dateStr] || 'unknown') : 'unknown';
            };
            
            const selectDate = (day) => {
                const dateStr = formatDate(day);
                const availability = getDayAvailability(day);
                
                if (availability !== 'booked' && availability !== 'unknown') {
                    setSelectedDate(dateStr);
                }
            };
            
            const renderCalendar = () => {
                const daysInMonth = getDaysInMonth(currentMonth, currentYear);
                const firstDay = getFirstDayOfMonth(currentMonth, currentYear);
                const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                                   'July', 'August', 'September', 'October', 'November', 'December'];
                
                let days = [];
                
                // Add empty cells for days before the first day of the month
                for (let i = 0; i < firstDay; i++) {
                    days.push(<div key={`empty-${i}`} className="calendar-day other-month"></div>);
                }
                
                // Add cells for each day of the month
                for (let day = 1; day <= daysInMonth; day++) {
                    const dateStr = formatDate(day);
                    const availability = getDayAvailability(day);
                    const isSelected = selectedDate === dateStr;
                    
                    days.push(
                        <div 
                            key={day} 
                            className={`calendar-day ${availability} ${isSelected ? 'selected' : ''}`}
                            onClick={() => selectDate(day)}
                        >
                            {day}
                        </div>
                    );
                }
                
                return (
                    <div className="calendar-container">
                        <div className="calendar-header">
                            <button className="calendar-nav" onClick={() => navigateMonth('prev')}>
                                <i className="fas fa-chevron-left"></i>
                            </button>
                            <div className="calendar-month">
                                {monthNames[currentMonth]} {currentYear}
                            </div>
                            <button className="calendar-nav" onClick={() => navigateMonth('next')}>
                                <i className="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        
                        <div className="calendar-grid">
                            <div className="calendar-weekday">Sun</div>
                            <div className="calendar-weekday">Mon</div>
                            <div className="calendar-weekday">Tue</div>
                            <div className="calendar-weekday">Wed</div>
                            <div className="calendar-weekday">Thu</div>
                            <div className="calendar-weekday">Fri</div>
                            <div className="calendar-weekday">Sat</div>
                            
                            {days}
                        </div>
                    </div>
                );
            };
            
            // Generate booking URL with query parameters
            const getBookingUrl = () => {
                if (!selectedDate || !selectedVendor) return "#";
                
                const params = new URLSearchParams();
                if (petType) params.append('petType', petType);
                if (location) params.append('location', location);
                if (petService) params.append('service', petService);
                params.append('date', selectedDate);
                params.append('vendor', selectedVendor);
                
                return `booking.html?${params.toString()}`;
            };
            
            // Filter vendors based on selected service
            const filteredVendors = petService 
                ? vendors.filter(vendor => vendor.services.some(s => s.toLowerCase().includes(petService.toLowerCase())))
                : vendors;

            return (
                <div>
                    <section className="hero">
                        <div className="container hero-content">
                            <h1>Premium Pet Services Matching in Singapore</h1>
                            <p>Find the best grooming, sitting, and hotel services for your beloved pets</p>
                        </div>
                    </section>

                    <div className="container">
                        <div className="search-section">
                            <h2 className="search-title">Find the perfect service for your pet</h2>
                            <div className="filters">
                                <div className="filter-group">
                                    <label>Pet Type</label>
                                    <div className="dropdown">
                                        <div className="dropdown-select" onClick={() => toggleDropdown('pet')}>
                                            <span>{petType || 'Select pet type'}</span>
                                            <i className={`fas fa-chevron-${showPetDropdown ? 'up' : 'down'}`}></i>
                                        </div>
                                        <div className={`dropdown-list ${showPetDropdown ? 'show' : ''}`}>
                                            {petTypes.map((pet, index) => (
                                                <div key={index} className="dropdown-item" onClick={() => { setPetType(pet); setShowPetDropdown(false); }}>
                                                    {pet}
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>

                                <div className="filter-group">
                                    <label>Location</label>
                                    <div className="dropdown">
                                        <div className="dropdown-select" onClick={() => toggleDropdown('location')}>
                                            <span>{location || 'Select location'}</span>
                                            <i className={`fas fa-chevron-${showLocationDropdown ? 'up' : 'down'}`}></i>
                                        </div>
                                        <div className={`dropdown-list ${showLocationDropdown ? 'show' : ''}`}>
                                            {locations.map((loc, index) => (
                                                <div key={index} className="dropdown-item" onClick={() => { setLocation(loc); setShowLocationDropdown(false); }}>
                                                    {loc}
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>

                                <div className="filter-group">
                                    <label>Pet Service</label>
                                    <div className="dropdown">
                                        <div className="dropdown-select" onClick={() => toggleDropdown('service')}>
                                            <span>{petService || 'Select service'}</span>
                                            <i className={`fas fa-chevron-${showServiceDropdown ? 'up' : 'down'}`}></i>
                                        </div>
                                        <div className={`dropdown-list ${showServiceDropdown ? 'show' : ''}`}>
                                            {services.map((service, index) => (
                                                <div key={index} className="dropdown-item" onClick={() => { setPetService(service); setShowServiceDropdown(false); }}>
                                                    {service}
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </div>

<div className="filter-group">
    <label>Select Date</label>
    
    <div className="vendor-selection-container">
        <div className="calendar-column">
            {renderCalendar()}
            
            <div className="availability-info">
                <div className="availability-title">Availability Legend:</div>
                <div className="availability-status">
                    <div className="status-color status-available"></div>
                    <span>Available - Multiple time slots open</span>
                </div>
                <div className="availability-status">
                    <div className="status-color status-limited"></div>
                    <span>Limited - Few slots remaining</span>
                </div>
                <div className="availability-status">
                    <div className="status-color status-booked"></div>
                    <span>Booked - No availability</span>
                </div>
            </div>
        </div>
        
        <div className="vendors-column">
            {petService && (
                <div className="vendor-selection">
                    <label>Select a Vendor</label>
                    <div className="vendor-cards">
                        {filteredVendors.map(vendor => (
                            <div 
                                key={vendor.id} 
                                className={`vendor-card ${selectedVendor === vendor.id ? 'selected' : ''}`}
                                onClick={() => setSelectedVendor(vendor.id)}
                            >
                                <div className="vendor-name">{vendor.name}</div>
                                <div className="vendor-rating">
                                    {'★'.repeat(Math.floor(vendor.rating))}
                                    {'☆'.repeat(5 - Math.floor(vendor.rating))}
                                    ({vendor.rating})
                                </div>
                                <div className="vendor-services">
                                    {vendor.services.map(service => (
                                        <span key={service} className="vendor-service-tag">{service}</span>
                                    ))}
                                </div>
                                <div className="vendor-price">{vendor.price}</div>
                                <div className="vendor-availability">
                                    {selectedDate && vendor.availability[selectedDate] && 
                                        `Availability: ${vendor.availability[selectedDate]}`}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            )}
        </div>
    </div>
</div>
</div>

<a 
    href={getBookingUrl()} 
    className="btn-search" 
    onClick={handleSearch}
>
    <i className="fas fa-search"></i> Search Services
</a>
                            
                            {selectedDate && selectedVendor && (
                                <div style={{marginTop: '15px', textAlign: 'center', color: 'var(--primary-brown)'}}>
                                    Selected: {new Date(selectedDate).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })} with {vendors.find(v => v.id === selectedVendor).name}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // Render the React component
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<PetServicesApp />);
    </script>
    <script>
    // Handle user icon click
    document.getElementById('userIcon').addEventListener('click', function() {
        const user = localStorage.getItem('user');
        if (user) {
            // User is logged in - show profile dropdown or redirect to profile
            alert('User is logged in!'); // Replace with actual profile page
        } else {
            // User is not logged in - redirect to login
            window.location.href = 'login.html';
        }
    });

    // Update user status on page load
    window.addEventListener('DOMContentLoaded', function() {
        const user = localStorage.getItem('user');
        const userStatus = document.getElementById('userStatus');
        
        if (user) {
            const userData = JSON.parse(user);
            userStatus.textContent = '✓';
            userStatus.style.display = 'inline';
            userStatus.style.color = 'green';
            userStatus.style.marginLeft = '5px';
            userStatus.style.fontSize = '12px';
        }
    });
</script>
</body>
</html>